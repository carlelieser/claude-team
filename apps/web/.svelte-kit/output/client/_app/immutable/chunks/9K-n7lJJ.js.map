{"version":3,"file":"9K-n7lJJ.js","sources":["../../../../../../src/lib/stores/projects.svelte.ts"],"sourcesContent":["/**\n * Project store using Svelte 5 runes\n */\n\nimport { ipc, type ProjectDto, type WorkspaceDto } from '$lib/ipc/client';\n\nclass ProjectStore {\n  currentProject = $state<ProjectDto | null>(null);\n  currentWorkspace = $state<WorkspaceDto | null>(null);\n  projects = $state<ProjectDto[]>([]);\n  workspaces = $state<WorkspaceDto[]>([]);\n  loading = $state(false);\n  error = $state<string | null>(null);\n\n  recentProjects = $derived(\n    [...this.projects]\n      .sort((a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime())\n      .slice(0, 5)\n  );\n\n  async loadWorkspaces(): Promise<void> {\n    this.loading = true;\n    this.error = null;\n\n    try {\n      const result = await ipc.workspace.list();\n\n      if (result.ok) {\n        this.workspaces = [...result.value];\n      } else {\n        this.error = result.error.message;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  async loadProjects(workspaceId?: string): Promise<void> {\n    this.loading = true;\n    this.error = null;\n\n    try {\n      const result = await ipc.project.list(workspaceId);\n\n      if (result.ok) {\n        this.projects = [...result.value];\n      } else {\n        this.error = result.error.message;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  async loadCurrent(): Promise<void> {\n    try {\n      const [projectResult, workspaceResult] = await Promise.all([\n        ipc.project.getCurrent(),\n        ipc.workspace.getCurrent(),\n      ]);\n\n      if (projectResult.ok) {\n        this.currentProject = projectResult.value;\n      }\n\n      if (workspaceResult.ok) {\n        this.currentWorkspace = workspaceResult.value;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    }\n  }\n\n  async switchProject(projectId: string): Promise<boolean> {\n    try {\n      const result = await ipc.project.switch(projectId);\n\n      if (result.ok) {\n        await this.loadCurrent();\n        return true;\n      } else {\n        this.error = result.error.message;\n        return false;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n      return false;\n    }\n  }\n\n  getProjectById(id: string): ProjectDto | undefined {\n    return this.projects.find((p) => p.id === id);\n  }\n\n  getWorkspaceById(id: string): WorkspaceDto | undefined {\n    return this.workspaces.find((w) => w.id === id);\n  }\n}\n\nexport const projectStore = new ProjectStore();\n"],"names":["ProjectStore","#currentProject","$.state","value","#currentWorkspace","$.proxy","#loading","#error","#recentProjects","$.derived","a","b","result","ipc","e","workspaceId","projectResult","workspaceResult","projectId","id","p","w","projectStore"],"mappings":"gGAMM,MAAAA,CAAa,CACAC,GAAAC,EAA0B,IAAI,MAA/C,gBAAA,uBAAA,eAAAC,EAAA,iBACmBC,GAAAF,EAA4B,IAAI,MAAnD,kBAAA,uBAAA,iBAAAC,EAAA,oBACWD,EAAAG,EAAA,CAAA,CAAA,CAAA,MAAX,UAAA,uBAAA,SAAAF,EAAA,oBACaD,EAAAG,EAAA,CAAA,CAAA,CAAA,MAAb,YAAA,uBAAA,WAAAF,EAAA,iBACUG,GAAAJ,EAAO,EAAK,MAAtB,SAAA,uBAAA,QAAAC,EAAA,iBACQI,GAAAL,EAAsB,IAAI,MAAlC,OAAA,uBAAA,MAAAC,EAAA,iBAGMK,GAAAC,EAAA,IAAA,CAAA,GAAA,KAAK,QAAQ,EACd,KAAA,CAAMC,EAAGC,IAAA,IAAU,KAAKA,EAAE,SAAS,EAAE,QAAA,EAAA,IAAgB,KAAKD,EAAE,SAAS,EAAE,QAAA,CAAA,EACvE,MAAM,EAAG,CAAC,CAAA,MAHf,gBAAA,uBAAA,eAAAP,EAAA,cAMM,MAAA,gBAAgC,CACpC,KAAK,QAAU,GACf,KAAK,MAAQ,QAET,CACI,MAAAS,EAAA,MAAeC,EAAI,UAAU,KAAA,EAE/BD,EAAO,GACT,KAAK,WAAA,CAAA,GAAiBA,EAAO,KAAK,EAElC,KAAK,MAAQA,EAAO,MAAM,OAE9B,OAASE,EAAG,CACV,KAAK,MAAQA,aAAa,MAAQA,EAAE,QAAU,eAChD,QAAA,CACE,KAAK,QAAU,EACjB,CACF,OAEM,aAAaC,EAAqC,CACtD,KAAK,QAAU,GACf,KAAK,MAAQ,QAET,CACI,MAAAH,QAAeC,EAAI,QAAQ,KAAKE,CAAW,EAE7CH,EAAO,GACT,KAAK,SAAA,CAAA,GAAeA,EAAO,KAAK,EAEhC,KAAK,MAAQA,EAAO,MAAM,OAE9B,OAAS,EAAG,CACV,KAAK,MAAQ,aAAa,MAAQ,EAAE,QAAU,eAChD,QAAA,CACE,KAAK,QAAU,EACjB,CACF,CAEM,MAAA,aAA6B,IAC7B,CACK,KAAA,CAAAI,EAAeC,CAAe,EAAA,MAAU,QAAQ,IAAA,CACrDJ,EAAI,QAAQ,WAAA,EACZA,EAAI,UAAU,WAAA,CAAA,CAAA,EAGZG,EAAc,KAChB,KAAK,eAAiBA,EAAc,OAGlCC,EAAgB,KAClB,KAAK,iBAAmBA,EAAgB,MAE5C,OAASH,EAAG,CACV,KAAK,MAAQA,aAAa,MAAQA,EAAE,QAAU,eAChD,CACF,OAEM,cAAcI,EAAqC,IACnD,CACI,MAAAN,QAAeC,EAAI,QAAQ,OAAOK,CAAS,SAE7CN,EAAO,IACH,MAAA,KAAK,YAAA,EACJ,KAEP,KAAK,MAAQA,EAAO,MAAM,QACnB,GAEX,OAAS,EAAG,CACV,YAAK,MAAQ,aAAa,MAAQ,EAAE,QAAU,gBACvC,EACT,CACF,CAEA,eAAeO,EAAoC,QAC1C,KAAK,SAAS,KAAMC,GAAMA,EAAE,KAAOD,CAAE,CAC9C,CAEA,iBAAiBA,EAAsC,QAC9C,KAAK,WAAW,KAAME,GAAMA,EAAE,KAAOF,CAAE,CAChD,CACF,CAEa,MAAAG,MAAmBtB"}