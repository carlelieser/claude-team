{"version":3,"file":"DKH1Kl_R.js","sources":["../../../../../../src/lib/stores/tasks.svelte.ts"],"sourcesContent":["/**\n * Task store using Svelte 5 runes\n */\n\nimport type { TaskStatus } from '@claude-team/core';\nimport {\n  ipc,\n  type TaskDto,\n  type CreateTaskDto,\n  type UpdateTaskDto,\n  type TaskFilterDto,\n} from '$lib/ipc/client';\n\nexport type ViewMode = 'kanban' | 'list';\n\nclass TaskStore {\n  tasks = $state<TaskDto[]>([]);\n  loading = $state(false);\n  error = $state<string | null>(null);\n  filter = $state<TaskFilterDto>({});\n  viewMode = $state<ViewMode>('kanban');\n\n  pendingTasks = $derived(this.tasks.filter((t) => t.status === 'pending'));\n  inProgressTasks = $derived(this.tasks.filter((t) => t.status === 'in_progress'));\n  completedTasks = $derived(this.tasks.filter((t) => t.status === 'completed'));\n  failedTasks = $derived(this.tasks.filter((t) => t.status === 'failed'));\n  canceledTasks = $derived(this.tasks.filter((t) => t.status === 'canceled'));\n\n  private _unsubscribeUpdated: (() => void) | null = null;\n\n  async load(filter?: TaskFilterDto): Promise<void> {\n    this.loading = true;\n    this.error = null;\n\n    if (filter) {\n      this.filter = filter;\n    }\n\n    try {\n      const result = await ipc.task.list(this.filter);\n\n      if (result.ok) {\n        this.tasks = [...result.value];\n      } else {\n        this.error = result.error.message;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  async create(data: CreateTaskDto): Promise<TaskDto | null> {\n    try {\n      const result = await ipc.task.create(data);\n\n      if (result.ok) {\n        this.tasks = [...this.tasks, result.value];\n        return result.value;\n      } else {\n        this.error = result.error.message;\n        return null;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n      return null;\n    }\n  }\n\n  async update(id: string, data: UpdateTaskDto): Promise<TaskDto | null> {\n    try {\n      const result = await ipc.task.update(id, data);\n\n      if (result.ok) {\n        const index = this.tasks.findIndex((t) => t.id === id);\n        if (index !== -1) {\n          this.tasks[index] = result.value;\n        }\n        return result.value;\n      } else {\n        this.error = result.error.message;\n        return null;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n      return null;\n    }\n  }\n\n  async cancel(id: string): Promise<boolean> {\n    try {\n      const result = await ipc.task.cancel(id);\n\n      if (result.ok) {\n        const index = this.tasks.findIndex((t) => t.id === id);\n        if (index !== -1) {\n          this.tasks[index] = { ...this.tasks[index]!, status: 'canceled' };\n        }\n        return true;\n      } else {\n        this.error = result.error.message;\n        return false;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n      return false;\n    }\n  }\n\n  setFilter(filter: TaskFilterDto): void {\n    this.filter = filter;\n    this.load();\n  }\n\n  setViewMode(mode: ViewMode): void {\n    this.viewMode = mode;\n  }\n\n  subscribe(): void {\n    this._unsubscribeUpdated = ipc.on.taskUpdated((task: TaskDto) => {\n      const index = this.tasks.findIndex((t) => t.id === task.id);\n      if (index !== -1) {\n        this.tasks[index] = task;\n      } else {\n        this.tasks = [...this.tasks, task];\n      }\n    });\n  }\n\n  unsubscribe(): void {\n    if (this._unsubscribeUpdated) {\n      this._unsubscribeUpdated();\n      this._unsubscribeUpdated = null;\n    }\n  }\n\n  getById(id: string): TaskDto | undefined {\n    return this.tasks.find((t) => t.id === id);\n  }\n\n  getByStatus(status: TaskStatus): TaskDto[] {\n    return this.tasks.filter((t) => t.status === status);\n  }\n}\n\nexport const taskStore = new TaskStore();\n"],"names":["TaskStore","$.state","$.proxy","value","#loading","#error","#viewMode","t","filter","result","ipc","e","data","id","index","mode","task","status","taskStore"],"mappings":"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"}