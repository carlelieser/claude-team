{"version":3,"file":"projects.svelte.js","sources":["../../../../src/lib/stores/projects.svelte.ts"],"sourcesContent":["/**\n * Project store using Svelte 5 runes\n */\n\nimport { ipc, type ProjectDto, type WorkspaceDto } from '$lib/ipc/client';\n\nclass ProjectStore {\n  currentProject = $state<ProjectDto | null>(null);\n  currentWorkspace = $state<WorkspaceDto | null>(null);\n  projects = $state<ProjectDto[]>([]);\n  workspaces = $state<WorkspaceDto[]>([]);\n  loading = $state(false);\n  error = $state<string | null>(null);\n\n  recentProjects = $derived(\n    [...this.projects]\n      .sort((a, b) => new Date(b.updatedAt).getTime() - new Date(a.updatedAt).getTime())\n      .slice(0, 5)\n  );\n\n  async loadWorkspaces(): Promise<void> {\n    this.loading = true;\n    this.error = null;\n\n    try {\n      const result = await ipc.workspace.list();\n\n      if (result.ok) {\n        this.workspaces = [...result.value];\n      } else {\n        this.error = result.error.message;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  async loadProjects(workspaceId?: string): Promise<void> {\n    this.loading = true;\n    this.error = null;\n\n    try {\n      const result = await ipc.project.list(workspaceId);\n\n      if (result.ok) {\n        this.projects = [...result.value];\n      } else {\n        this.error = result.error.message;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    } finally {\n      this.loading = false;\n    }\n  }\n\n  async loadCurrent(): Promise<void> {\n    try {\n      const [projectResult, workspaceResult] = await Promise.all([\n        ipc.project.getCurrent(),\n        ipc.workspace.getCurrent(),\n      ]);\n\n      if (projectResult.ok) {\n        this.currentProject = projectResult.value;\n      }\n\n      if (workspaceResult.ok) {\n        this.currentWorkspace = workspaceResult.value;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n    }\n  }\n\n  async switchProject(projectId: string): Promise<boolean> {\n    try {\n      const result = await ipc.project.switch(projectId);\n\n      if (result.ok) {\n        await this.loadCurrent();\n        return true;\n      } else {\n        this.error = result.error.message;\n        return false;\n      }\n    } catch (e) {\n      this.error = e instanceof Error ? e.message : 'Unknown error';\n      return false;\n    }\n  }\n\n  getProjectById(id: string): ProjectDto | undefined {\n    return this.projects.find((p) => p.id === id);\n  }\n\n  getWorkspaceById(id: string): WorkspaceDto | undefined {\n    return this.workspaces.find((w) => w.id === id);\n  }\n}\n\nexport const projectStore = new ProjectStore();\n"],"names":["$.derived"],"mappings":";;AAMM,MAAA,aAAa;AAAA,EACjB,iBAA2C;AAAA,EAC3C,mBAA+C;AAAA,EAC/C,WAAA,CAAA;AAAA,EACA,aAAA,CAAA;AAAA,EACA,UAAiB;AAAA,EACjB,QAA8B;AAAA,EAGxB,kBAAAA,QAAA,MAAA,CAAA,GAAA,KAAK,QAAQ,EACd,KAAA,CAAM,GAAG,MAAA,IAAU,KAAK,EAAE,SAAS,EAAE,QAAA,IAAA,IAAgB,KAAK,EAAE,SAAS,EAAE,QAAA,CAAA,EACvE,MAAM,GAAG,CAAC,CAAA;AAAA,MAHf,iBAAA;;;;;;EAMM,MAAA,iBAAgC;AACpC,SAAK,UAAU;AACf,SAAK,QAAQ;QAET;AACI,YAAA,SAAA,MAAe,IAAI,UAAU,KAAA;UAE/B,OAAO,IAAI;AACb,aAAK,aAAA,CAAA,GAAiB,OAAO,KAAK;AAAA,MACpC,OAAO;AACL,aAAK,QAAQ,OAAO,MAAM;AAAA,MAC5B;AAAA,IACF,SAAS,GAAG;AACV,WAAK,QAAQ,aAAa,QAAQ,EAAE,UAAU;AAAA,IAChD,UAAA;AACE,WAAK,UAAU;AAAA,IACjB;AAAA,EACF;AAAA,QAEM,aAAa,aAAqC;AACtD,SAAK,UAAU;AACf,SAAK,QAAQ;QAET;AACI,YAAA,eAAe,IAAI,QAAQ,KAAK,WAAW;UAE7C,OAAO,IAAI;AACb,aAAK,WAAA,CAAA,GAAe,OAAO,KAAK;AAAA,MAClC,OAAO;AACL,aAAK,QAAQ,OAAO,MAAM;AAAA,MAC5B;AAAA,IACF,SAAS,GAAG;AACV,WAAK,QAAQ,aAAa,QAAQ,EAAE,UAAU;AAAA,IAChD,UAAA;AACE,WAAK,UAAU;AAAA,IACjB;AAAA,EACF;AAAA,EAEM,MAAA,cAA6B;QAC7B;AACK,YAAA,CAAA,eAAe,eAAe,IAAA,MAAU,QAAQ,IAAA,CACrD,IAAI,QAAQ,WAAA,GACZ,IAAI,UAAU,WAAA,CAAA,CAAA;UAGZ,cAAc,IAAI;AACpB,aAAK,iBAAiB,cAAc;AAAA,MACtC;UAEI,gBAAgB,IAAI;AACtB,aAAK,mBAAmB,gBAAgB;AAAA,MAC1C;AAAA,IACF,SAAS,GAAG;AACV,WAAK,QAAQ,aAAa,QAAQ,EAAE,UAAU;AAAA,IAChD;AAAA,EACF;AAAA,QAEM,cAAc,WAAqC;QACnD;AACI,YAAA,eAAe,IAAI,QAAQ,OAAO,SAAS;UAE7C,OAAO,IAAI;AACP,cAAA,KAAK,YAAA;eACJ;AAAA,MACT,OAAO;AACL,aAAK,QAAQ,OAAO,MAAM;eACnB;AAAA,MACT;AAAA,IACF,SAAS,GAAG;AACV,WAAK,QAAQ,aAAa,QAAQ,EAAE,UAAU;aACvC;AAAA,IACT;AAAA,EACF;AAAA,EAEA,eAAe,IAAoC;WAC1C,KAAK,SAAS,KAAA,CAAM,MAAM,EAAE,OAAO,EAAE;AAAA,EAC9C;AAAA,EAEA,iBAAiB,IAAsC;WAC9C,KAAK,WAAW,KAAA,CAAM,MAAM,EAAE,OAAO,EAAE;AAAA,EAChD;AACF;AAEa,MAAA,mBAAmB,aAAA;"}